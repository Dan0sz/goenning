<!DOCTYPE html>
<html lang="pt">
  <head>
    <title>Como reduzimos o tamanho inicial do JS e CSS em 67% – @goenning</title>

    <meta charset="utf-8" />
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" type="text/css" href="/style.css" />  <!-- Icons -->
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="alternate" type="application/rss+xml" title="@goenning - loop at { run; code; blog; swim; eat; cycle; } until tired;" href="/feed.xml" />
    

    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Como reduzimos o tamanho inicial do JS e CSS em 67% | @goenning</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Como reduzimos o tamanho inicial do JS e CSS em 67%" />
<meta name="author" content="@goenning" />
<meta property="og:locale" content="pt" />
<meta name="description" content="Recentemente fizemos várias melhorias no Fider para reduzir a quantidade total de bytes que são enviados aos navegadores. Por ser uma aplicação em React, nós focamos bastante em reduzir o JavaScript e CSS sem remover nenhuma funcionalidade. Neste post vamos compartilhar o que aprendemos, alguns conceitos e sugestões de como você pode fazer o mesmo em suas aplicações web." />
<meta property="og:description" content="Recentemente fizemos várias melhorias no Fider para reduzir a quantidade total de bytes que são enviados aos navegadores. Por ser uma aplicação em React, nós focamos bastante em reduzir o JavaScript e CSS sem remover nenhuma funcionalidade. Neste post vamos compartilhar o que aprendemos, alguns conceitos e sugestões de como você pode fazer o mesmo em suas aplicações web." />
<link rel="canonical" href="https://goenning.net/2018/11/26/como-reduzimos-tamanho-inicial-js-css/" />
<meta property="og:url" content="https://goenning.net/2018/11/26/como-reduzimos-tamanho-inicial-js-css/" />
<meta property="og:site_name" content="@goenning" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-11-26T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Como reduzimos o tamanho inicial do JS e CSS em 67%" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"@goenning"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://goenning.net/2018/11/26/como-reduzimos-tamanho-inicial-js-css/"},"@type":"BlogPosting","description":"Recentemente fizemos várias melhorias no Fider para reduzir a quantidade total de bytes que são enviados aos navegadores. Por ser uma aplicação em React, nós focamos bastante em reduzir o JavaScript e CSS sem remover nenhuma funcionalidade. Neste post vamos compartilhar o que aprendemos, alguns conceitos e sugestões de como você pode fazer o mesmo em suas aplicações web.","headline":"Como reduzimos o tamanho inicial do JS e CSS em 67%","dateModified":"2018-11-26T00:00:00-06:00","url":"https://goenning.net/2018/11/26/como-reduzimos-tamanho-inicial-js-css/","datePublished":"2018-11-26T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/pt" class="site-avatar"><img width="70" height="70" alt="@goenning" src="https://avatars.githubusercontent.com/u/94755?s=210" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/pt">@goenning</a></h1>
            <p class="site-description">loop at { run; code; blog; swim; eat; cycle; } until tired;</p>
          </div>

          <nav>
            
              <a href="/pt">Blog</a>
            
              <a href="/arquivo">Arquivo</a>
            
              <a href="/projetos">Projetos</a>
            

            <div class="langs">
              
              
              
              
              
              <a href="/2018/11/26/como-reduzimos-tamanho-inicial-js-css/" title="Português" class="flag">
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 480" height="100%" width="100%">
  <g stroke-width="1pt">
    <path fill-rule="evenodd" fill="#229e45" d="M0 0h640v480H0z"/>
    <path d="M321.406 435.935l301.483-195.67-303.308-196.2L17.11 240.734l304.296 195.2z" fill-rule="evenodd" fill="#f8e509"/>
    <path d="M452.77 240.005c0 70.328-57.103 127.34-127.544 127.34-70.442 0-127.544-57.012-127.544-127.34s57.104-127.34 127.544-127.34c70.442 0 127.545 57.012 127.545 127.34z" fill-rule="evenodd" fill="#2b49a3"/>
    <path fill="#ffffef" fill-rule="evenodd" d="M283.3 316.274L279.357 314l-4.093 2.025.917-4.55-3.162-3.332 4.52-.53 2.124-4.08 1.894 4.22 4.46.81-3.345 3.13M368.77 337.917l-3.94-2.274-4.092 2.025.916-4.55-3.16-3.332 4.52-.53 2.122-4.08 1.894 4.22 4.46.81-3.345 3.13M331.93 303.343l-3.404-1.964-3.536 1.748.792-3.93-2.73-2.88 3.904-.457 1.834-3.523 1.636 3.645 3.853.7-2.89 2.705M418.254 290.91l-3.342-1.928-3.472 1.718.777-3.858-2.68-2.827 3.833-.45 1.8-3.46 1.607 3.58 3.783.686-2.837 2.657M330.37 265.03l-3.94-2.273-4.093 2.025.916-4.55-3.162-3.332 4.522-.53 2.123-4.08 1.894 4.22 4.46.81-3.346 3.13M225.13 225.52l-3.94-2.274-4.094 2.025.916-4.548-3.16-3.333 4.52-.53 2.122-4.08 1.894 4.22 4.46.81-3.345 3.13M237.786 278.08l-3.94-2.275-4.094 2.025.916-4.548-3.16-3.334 4.52-.53 2.123-4.08 1.894 4.22 4.46.81-3.345 3.132M369.114 206.17l-3.48-2.007-3.616 1.788.81-4.017-2.794-2.944 3.994-.47 1.875-3.603 1.673 3.728 3.94.715-2.955 2.766M361.896 240.366l-2.74-1.582-2.85 1.408.64-3.164-2.2-2.32 3.145-.368 1.477-2.838 1.318 2.936 3.103.563-2.327 2.18M219.263 287.603l-2.63-1.518-2.734 1.352.61-3.037-2.11-2.225 3.02-.354 1.416-2.723 1.264 2.818 2.978.54-2.233 2.09M418.984 299.71l-2.144-1.135-2.227 1.01.5-2.27-1.72-1.666 2.46-.265 1.154-2.038 1.03 2.108 2.426.404-1.82 1.563"/>
    <path fill="#ffffef" fill-rule="evenodd" d="M219.263 287.603l-2.63-1.518-2.734 1.352.61-3.037-2.11-2.225 3.02-.354 1.416-2.723 1.264 2.818 2.978.54-2.233 2.09"/>
    <path fill="#ffffef" fill-rule="evenodd" d="M219.263 287.603l-2.63-1.518-2.734 1.352.61-3.037-2.11-2.225 3.02-.354 1.416-2.723 1.264 2.818 2.978.54-2.233 2.09M261.143 287.594l-2.63-1.52-2.733 1.353.61-3.037-2.11-2.225 3.02-.354 1.416-2.722 1.265 2.817 2.978.54-2.233 2.09M255.94 301.525l-2.63-1.518-2.734 1.352.612-3.038-2.11-2.225 3.017-.354 1.417-2.724 1.265 2.817 2.977.54-2.233 2.09M342.902 276.164l-2.63-1.52-2.733 1.353.61-3.036-2.11-2.225 3.018-.353 1.417-2.724 1.265 2.817 2.977.54-2.233 2.09M317.384 276.154l-2.63-1.518-2.734 1.352.612-3.037-2.11-2.225 3.018-.353 1.417-2.724 1.264 2.817 2.98.54-2.234 2.09M248.167 267.258l-1.648-.952-1.714.847.384-1.902-1.323-1.394 1.89-.222.89-1.706.792 1.765 1.864.34-1.4 1.31M415.74 310.728l-2.63-1.518-2.733 1.35.612-3.035-2.11-2.226 3.017-.354 1.417-2.724 1.264 2.817 2.978.54-2.233 2.09M394.49 313.512l-2.178-1.26-2.264 1.122.507-2.522-1.748-1.848 2.5-.294 1.174-2.262 1.048 2.34 2.466.45-1.85 1.735M404.516 313.27l-2.03-1.173-2.108 1.044.472-2.344-1.63-1.718 2.33-.274 1.093-2.103.976 2.177 2.296.417-1.723 1.615M433.302 288.15l-1.955-1.13-2.03 1.006.454-2.257-1.567-1.655 2.243-.262 1.053-2.024.94 2.092 2.21.402-1.658 1.553M394.24 327.69l-2.554-1.395-2.652 1.24.594-2.786-2.05-2.043 2.93-.325 1.376-2.5 1.227 2.586 2.89.496-2.167 1.92M394.383 339.13l-2.33-1.395-2.418 1.24.542-2.786-1.87-2.044 2.673-.324 1.255-2.5 1.12 2.586 2.635.496-1.977 1.918M375.084 313.266l-1.955-1.13-2.032 1.006.455-2.257-1.568-1.653 2.242-.263 1.054-2.025.94 2.093 2.213.402-1.66 1.554M356.992 313.266l-1.954-1.13-2.03 1.006.454-2.257-1.57-1.653 2.244-.263 1.053-2.025.94 2.093 2.21.402-1.658 1.554M326.273 286.403l-1.955-1.128-2.03 1.004.454-2.257-1.568-1.654 2.243-.264 1.053-2.024.94 2.094 2.212.402-1.66 1.553M329.696 341.153l-1.656-.956-1.72.85.386-1.91-1.33-1.4 1.9-.223.893-1.715.795 1.772 1.874.34-1.407 1.316M283.3 252.597l-3.942-2.274-4.093 2.025.917-4.548-3.162-3.334 4.52-.53 2.124-4.08 1.894 4.22 4.46.81-3.345 3.132"/>
    <path d="M444.368 285.817c1.944-5.083 4.45-12.75 5.783-19.786-67.742-59.508-143.26-89.993-238.68-83.72-3.422 6.558-6.16 13.423-8.47 20.853 113.063-10.786 195.936 39.27 241.37 82.654z" fill-rule="evenodd" fill="#fff"/>
    <path d="M413.914 252.36l2.42 1.323c-.38.858-.48 1.61-.31 2.25.18.645.625 1.208 1.335 1.688.75.515 1.424.74 2.016.68.6-.06 1.045-.306 1.335-.734.183-.274.258-.563.225-.863-.027-.3-.192-.66-.495-1.075-.21-.28-.72-.873-1.53-1.777-1.04-1.16-1.66-2.138-1.86-2.936-.28-1.122-.11-2.14.51-3.06.4-.59.936-1.03 1.612-1.318.686-.29 1.433-.355 2.24-.198.81.157 1.664.54 2.55 1.143 1.453.987 2.33 2.048 2.63 3.184.305 1.138.117 2.253-.565 3.345l-2.404-1.484c.3-.665.375-1.24.218-1.723-.147-.485-.55-.95-1.21-1.397-.676-.46-1.302-.682-1.874-.663-.37.01-.654.168-.856.468-.186.277-.228.59-.13.943.13.45.668 1.193 1.625 2.234.953 1.04 1.604 1.89 1.95 2.547.355.657.516 1.34.482 2.05-.023.706-.284 1.427-.778 2.16-.45.667-1.053 1.163-1.812 1.493-.76.33-1.57.412-2.437.24-.86-.177-1.794-.607-2.798-1.29-1.462-.992-2.36-2.093-2.687-3.3-.322-1.213-.125-2.523.6-3.925zM402.436 244.827l2.472 1.22c-.345.872-.417 1.628-.22 2.26.208.637.672 1.183 1.4 1.635.775.482 1.455.68 2.043.596.6-.086 1.037-.346 1.306-.786.174-.28.236-.573.19-.87-.038-.302-.218-.655-.54-1.058-.22-.272-.75-.84-1.597-1.713-1.087-1.117-1.746-2.07-1.978-2.86-.323-1.11-.194-2.133.385-3.077.378-.606.896-1.066 1.56-1.38.674-.316 1.42-.413 2.23-.29.818.127 1.685.473 2.595 1.04 1.492.926 2.408 1.952 2.753 3.074.35 1.126.21 2.247-.427 3.365l-2.464-1.385c.275-.676.327-1.252.15-1.728-.168-.482-.59-.93-1.264-1.35-.697-.433-1.33-.628-1.9-.586-.37.025-.647.195-.838.504-.172.282-.204.594-.09.944.145.443.714 1.165 1.71 2.168.994 1 1.68 1.822 2.052 2.465.38.64.568 1.318.563 2.027.007.708-.227 1.437-.69 2.193-.42.68-1.008 1.202-1.75 1.565-.746.36-1.556.474-2.427.336-.865-.14-1.815-.536-2.848-1.175-1.498-.933-2.438-1.996-2.815-3.19-.374-1.2-.23-2.514.438-3.943zM388.23 241.02l7.276-11.966 8.837 5.416-1.23 2.026-6.43-3.942-1.615 2.652 5.983 3.668-1.225 2.015-5.984-3.667-1.977 3.256 6.657 4.08-1.228 2.017-9.063-5.557zM367.538 224.027l1.08-2.1 5.4 2.796-2.546 4.962c-.79.238-1.78.296-2.982.17-1.19-.13-2.295-.457-3.317-.986-1.3-.673-2.29-1.528-2.976-2.572-.683-1.05-1.01-2.205-.974-3.47.04-1.274.363-2.507.977-3.703.664-1.298 1.53-2.31 2.59-3.04 1.057-.727 2.25-1.09 3.57-1.09 1.008-.002 2.104.306 3.29.916 1.542.8 2.577 1.747 3.104 2.846.54 1.096.638 2.28.298 3.555l-2.728-.82c.14-.702.057-1.356-.25-1.957-.296-.606-.806-1.095-1.527-1.47-1.097-.567-2.146-.67-3.155-.305-1 .363-1.85 1.23-2.554 2.6-.76 1.48-1.005 2.76-.73 3.842.277 1.073.944 1.886 2.008 2.437.524.27 1.1.44 1.73.507.64.066 1.22.05 1.753-.05l.81-1.582-2.872-1.485zM277.296 201.648l2.034-13.867 4.172.62 1.123 9.826 3.86-9.093 4.188.618-2.033 13.87-2.59-.382 1.6-10.918-4.343 10.512-2.685-.398-1.134-11.32-1.6 10.915-2.592-.382zM263.188 200.01l1.305-13.96 10.307.974-.217 2.36-7.503-.706-.29 3.095 6.978.657-.22 2.352-6.98-.658-.353 3.8 7.764.73-.22 2.354-10.572-.998z" fill="#309e3a"/>
    <g stroke-opacity=".502">
      <path d="M216.5 191.28c.04-1.43.284-2.62.736-3.58.335-.703.786-1.332 1.346-1.884.566-.552 1.18-.956 1.844-1.21.88-.347 1.888-.505 3.023-.475 2.056.06 3.682.744 4.877 2.057 1.205 1.315 1.775 3.114 1.714 5.395-.06 2.26-.72 4.017-1.982 5.264-1.26 1.24-2.914 1.834-4.963 1.777-2.077-.056-3.708-.736-4.9-2.037-1.19-1.308-1.755-3.078-1.694-5.307z" fill="#309e3a"/>
      <path d="M219.414 191.252c-.043 1.586.29 2.8.997 3.643.708.837 1.625 1.27 2.748 1.3 1.122.03 2.055-.35 2.794-1.138.745-.797 1.14-2.007 1.184-3.633.043-1.605-.277-2.813-.96-3.622-.676-.81-1.595-1.23-2.757-1.262-1.162-.03-2.11.345-2.843 1.128-.733.777-1.12 1.972-1.163 3.584z" fill="#f7ffff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M233.052 198.51l.163-14.017 5.933.07c1.494.018 2.574.157 3.244.42.677.257 1.214.71 1.613 1.36s.593 1.385.584 2.215c-.013 1.052-.332 1.918-.956 2.598-.623.675-1.55 1.095-2.777 1.26.605.363 1.104.76 1.49 1.193.397.43.923 1.195 1.585 2.293l1.673 2.754-3.372-.04-2.002-3.074c-.71-1.098-1.198-1.788-1.46-2.072-.265-.29-.545-.487-.842-.593-.297-.11-.77-.17-1.418-.177l-.57-.008-.068 5.852-2.82-.033z" fill="#309e3a"/>
      <path d="M235.976 190.455l2.086.024c1.353.016 2.198-.03 2.536-.142.337-.112.603-.305.796-.584s.293-.627.3-1.048c.004-.472-.118-.853-.37-1.142-.243-.296-.594-.486-1.05-.567-.23-.034-.915-.06-2.057-.072l-2.2-.026-.04 3.555z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M249.003 185.188l5.147.26c1.16.06 2.04.195 2.64.405.804.283 1.484.75 2.036 1.396.553.646.958 1.426 1.218 2.34.26.907.356 2.015.29 3.326-.058 1.153-.252 2.138-.58 2.96-.4 1-.938 1.797-1.618 2.396-.51.453-1.19.79-2.034 1.016-.632.166-1.468.222-2.51.17l-5.295-.27.706-14z" fill="#309e3a"/>
      <path d="M251.706 187.685l-.468 9.274 2.103.105c.786.042 1.357.025 1.71-.046.46-.093.85-.268 1.16-.526.32-.26.59-.695.81-1.31.223-.62.36-1.47.416-2.553s0-1.918-.16-2.507c-.16-.59-.404-1.053-.73-1.397-.327-.342-.75-.583-1.27-.724-.39-.11-1.157-.193-2.306-.25l-1.264-.067z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M317.63 210.22l3.26-13.63 4.4 1.06c1.666.402 2.737.732 3.21.99.73.392 1.274.996 1.634 1.81.36.81.41 1.755.152 2.84-.2.836-.518 1.504-.958 2-.438.5-.932.854-1.48 1.07-.54.212-1.064.31-1.57.3-.685-.028-1.65-.19-2.89-.49l-1.786-.432-1.23 5.142-2.743-.66z" fill="#309e3a"/>
      <path d="M323.086 199.552l-.926 3.868 1.5.362c1.082.26 1.82.364 2.218.308.4-.055.736-.21 1.013-.464.283-.253.473-.58.568-.984.12-.496.073-.94-.14-1.33-.214-.395-.533-.684-.957-.87-.312-.143-.96-.332-1.95-.57l-1.324-.32z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M330.606 214.106l4.64-13.22 5.598 1.98c1.408.498 2.387.98 2.937 1.445.56.463.923 1.064 1.093 1.807s.12 1.505-.156 2.286c-.348.992-.928 1.71-1.736 2.153-.806.438-1.817.537-3.032.298.457.54.802 1.076 1.03 1.61.238.536.49 1.43.765 2.683l.704 3.15-3.18-1.126-.913-3.556c-.322-1.27-.562-2.08-.72-2.435-.158-.36-.36-.638-.607-.834-.246-.202-.673-.41-1.286-.627l-.536-.192-1.938 5.52-2.66-.942z" fill="#309e3a"/>
      <path d="M335.938 207.426l1.967.695c1.276.452 2.09.68 2.445.683.355.005.67-.093.943-.295.272-.2.478-.5.616-.896.155-.445.162-.845.017-1.2-.135-.36-.408-.65-.813-.876-.206-.106-.847-.35-1.924-.73l-2.075-.736-1.177 3.356z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M347.01 213.6c.424-1.363.982-2.444 1.673-3.24.517-.59 1.117-1.072 1.808-1.45.696-.377 1.397-.598 2.102-.665.94-.093 1.953.03 3.038.37 1.965.614 3.344 1.717 4.14 3.308.803 1.593.867 3.48.19 5.658-.67 2.162-1.78 3.67-3.33 4.528-1.548.852-3.302.97-5.26.357-1.982-.62-3.37-1.718-4.164-3.294-.793-1.583-.858-3.44-.196-5.57z" fill="#309e3a"/>
      <path d="M349.826 214.385c-.47 1.514-.48 2.773-.026 3.778.455.996 1.22 1.663 2.293 2 1.073.334 2.07.223 2.996-.336.932-.562 1.64-1.62 2.122-3.172.476-1.535.495-2.783.056-3.75-.432-.962-1.204-1.618-2.313-1.964-1.11-.347-2.123-.243-3.04.312-.915.548-1.61 1.592-2.09 3.133z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M374.305 233.12l6.415-12.45 5.27 2.736c1.326.69 2.23 1.3 2.71 1.84.49.532.768 1.18.835 1.94s-.092 1.505-.47 2.242c-.48.934-1.153 1.564-2.017 1.892-.86.322-1.872.28-3.043-.128.378.598.645 1.18.8 1.74.158.564.288 1.484.387 2.763l.262 3.215-2.993-1.555-.415-3.648c-.145-1.304-.27-2.14-.378-2.512-.105-.377-.27-.682-.487-.91-.214-.233-.61-.5-1.186-.798l-.507-.264-2.677 5.197-2.505-1.3z" fill="#309e3a"/>
      <path d="M380.503 227.226l1.853.962c1.2.625 1.977.962 2.33 1.016.35.054.675 0 .973-.162.296-.16.54-.428.733-.803.216-.42.276-.814.184-1.186-.087-.374-.315-.702-.685-.98-.19-.134-.79-.465-1.808-.993l-1.952-1.013-1.63 3.16z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M426.107 258.704c.797-1.183 1.642-2.056 2.536-2.62.662-.412 1.377-.7 2.146-.862.774-.16 1.507-.168 2.2-.028.93.184 1.864.596 2.805 1.235 1.704 1.156 2.708 2.612 3.014 4.366.31 1.758-.173 3.58-1.448 5.472-1.263 1.873-2.758 2.998-4.488 3.37-1.728.365-3.44-.028-5.14-1.182-1.718-1.168-2.732-2.622-3.04-4.362-.303-1.746.168-3.543 1.413-5.39z" fill="#309e3a"/>
      <path d="M428.578 260.254c-.886 1.316-1.256 2.518-1.112 3.61.15 1.087.69 1.945 1.62 2.578.932.632 1.92.815 2.967.55 1.055-.27 2.037-1.077 2.944-2.425.896-1.33 1.273-2.52 1.13-3.572-.138-1.047-.688-1.898-1.65-2.552s-1.962-.85-3-.583c-1.033.26-1.998 1.06-2.9 2.394z" fill="#fff"/>
    </g>
    <path d="M301.824 204.523l2.248-9.84 7.268 1.675-.378 1.662-5.287-1.217-.504 2.18 4.926 1.136-.382 1.655-4.918-1.132-.614 2.677 5.475 1.26-.378 1.66-7.456-1.717z" fill="#309e3a"/>
  </g>
</svg>

              </a>
              <a href="/2018/11/26/how-we-reduced-initial-jscss-size/" title="English" class="flag">
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 480" height="100%" width="100%">
  <defs>
    <clipPath id="a">
      <path fill-opacity=".67" d="M-85.333 0h682.67v512h-682.67z"/>
    </clipPath>
  </defs>
  <g clip-path="url(#a)" transform="matrix(.94 0 0 .94 80 0)">
    <g stroke-width="1pt">
      <path fill="#006" d="M-256 0H768.02v512.01H-256z"/>
      <path d="M-256 0v57.244l909.535 454.768H768.02V454.77L-141.515 0H-256zM768.02 0v57.243L-141.515 512.01H-256v-57.243L653.535 0H768.02z" fill="#fff"/>
      <path d="M170.675 0v512.01h170.67V0h-170.67zM-256 170.67v170.67H768.02V170.67H-256z" fill="#fff"/>
      <path d="M-256 204.804v102.402H768.02V204.804H-256zM204.81 0v512.01h102.4V0h-102.4zM-256 512.01L85.34 341.34h76.324l-341.34 170.67H-256zM-256 0L85.34 170.67H9.016L-256 38.164V0zm606.356 170.67L691.696 0h76.324L426.68 170.67h-76.324zM768.02 512.01L426.68 341.34h76.324L768.02 473.848v38.162z" fill="#c00"/>
    </g>
  </g>
</svg>

              </a>
            </div>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>Como reduzimos o tamanho inicial do JS e CSS em 67%</h1>

  <small>
    


  26 de
  Novembro
      
  de 2018

    


  
    • 11 minutos para ler
  

    • 
  <a href="/tags/pt#react">react</a>,

  <a href="/tags/pt#performance">performance</a>,

  <a href="/tags/pt#web">web</a>

  </small>

  <div class="entry">
    <p><img src="/public/images/2018/11/bundle-size-improvements.png" alt="" /></p>

<p>Fider foi construído com React e Webpack no frontend, por isto o tópicos abaixo são mais úteis para quem utiliza as mesmas tecnologias, mas muitos conceitos podem ser aplicados em Angular e Vue.js, por exemplo.</p>

<h3 id="índice">Índice</h3>

<ul>
  <li><a href="#webpack-bundle-analyzer">Webpack Bundle Analyzer</a></li>
  <li><a href="#cache-de-longa-duração-com-hash-de-conteúdo">Cache de longa duração com hash de conteúdo</a></li>
  <li><a href="#o-bundle-comum">O bundle comum</a></li>
  <li><a href="#divisão-de-código-baseada-em-rotas">Divisão de código baseada em rotas</a></li>
  <li><a href="#carregando-dependências-externas-por-demanda">Carregando dependências externas por demanda</a></li>
  <li><a href="#font-awesome-e-tree-shaking">Font Awesome e Tree Shaking</a></li>
  <li><a href="#trocando-grandes-pacotes-npm-por-opções-menores">Trocando grandes pacotes NPM por opções menores</a></li>
  <li><a href="#otimizando-o-bundle-principal-é-crucial">Otimizando o bundle principal é crucial</a></li>
  <li><a href="#tslib-apenas-para-usuários-de-typescript">TSLib (apenas para usuários de TypeScript)</a></li>
</ul>

<h2 id="webpack-bundle-analyzer">Webpack Bundle Analyzer</h2>

<p><a href="https://www.npmjs.com/package/webpack-bundle-analyzer">webpack-bundle-analyzer</a> é um plugin para o webpack que gera um mapa interativo de todos os bundles da aplicação. Isto foi crucial para nós entendermos quais são os módulos que estão dentro de cada bundle. Este mapa inclui não só o nome, mas também o tamanho de cada módulo.</p>

<p><em>Se você não sabe qual a raiz do problema, como você o resolve?</em></p>

<p>Este é um exemplo do que do mapa que o plugin gerou para nós.</p>

<p><img src="/public/images/2018/11/bundle-size-initial-view.png" alt="" /></p>

<p>Você notou aquele enorme <strong>entities.json</strong> dentro do vendor bundle? Aquele é um bom candidato a ser analizado para saber o que pode ser feito para minimizar o tamanho dos bundles.</p>

<h2 id="cache-de-longa-duração-com-hash-de-conteúdo">Cache de longa duração com hash de conteúdo</h2>

<p>Cache de longa duração é o processo de instruir o navegador a fazer o cache de um arquivo por um longo tempo, por exemplo, 3 meses ou até mesmo 1 ano. Isto é muito importante para garantir que visitantes recorrentes não precisam fazer o download dos mesmos arquivos JavaScript/CSS novamente.</p>

<p>O navegador fará o cache dos arquivos baseados no seu nome completo, então se você precisa forçar o download de uma nova versão de seu bundle, é só garantir que o nome seja diferente. O webpack possui uma funcionalidade que gera o nome dos arquivos com base em algum critério.</p>

<p>Anteriormente estávamos usando a configuração <strong>chunkhash</strong> do webpack para fazer o cache de longa duração, mas em 99% dos casos, a melhor opção é usar <strong>contenthash</strong>. Esta configuração faz com que o webpack gere o nome do arquivo vaseado no seu conteúdo.</p>

<p>Esta configuração não reduz o tamanho total do bundle, mas certamente ajuda na hora de reduzir a quantidade de vezes que o usuários precisa fazer o download. Se o bundle não for alterado, não há necessidade de forçar nenhum download.</p>

<p>Caso queira saber mais sobre isto, visite https://webpack.js.org/guides/caching/</p>

<h2 id="o-bundle-comum">O bundle comum</h2>

<p>Combinar todos os pacotes NPM em um bundle separatado é algo bem comum em vários projetos. Isto é muito útil quando combinado com o cache de longa duração.</p>

<p>Pacotes NPM são alterados com menos frequência do que nosso código, então assim não forçamos os visitantes a fazer o download do bundle enquanto os pacotes do NPM não forem atualizados. Este bundle é normalmente chamado de <strong>vendor bundle</strong>.</p>

<p>Mas é possível levar este conceito um passo à diante.</p>

<p>Já pensou que no seu próprio código existem algumas partes que raramente são alteradas? Talvez você tenha alguns componentes básicos como Botão, Tabela, Alertas, etc. que foram criados à muito tempo atrás e que já faz tempo que não são alterados.</p>

<p>Estes módulos são excelentes candidados para fazerem parte do <strong>common bundle</strong>. Veja esta <a href="https://github.com/getfider/fider/pull/636">PR #636</a> onde nós basicamente movemos todos os nossos próprios módulos de dentro de um diretório específico para um bundle comum.</p>

<p>Isto garante que, a não ser que nossos componentes básicos forem alterados, os visitantes do Fider não terão que fazer download deles novamente.</p>

<h2 id="divisão-de-código-baseada-em-rotas">Divisão de código baseada em rotas</h2>

<p>Divisão de código (code splitting) é um tópico que está na moda. Esta técnica já existe há algum tempo, mas com a evolução das ferramentas e frameworks, fazer divisão de código ficou mais simples agora.</p>

<p>É muito comum ver aplicações web que colocam todo o conteúdo JS/CSS em um único arquivo. Este arquivo possui o código necessário para renderizar qualquer página da aplicação, mesmo que os visitantes esteja olhando apenas a página inicial. Não sabemos se os visitantes vão visiar a página de configuração, mas mesmo assim fazemos com eles empurramos todo o JavaScript para eles. O Fider sempre foi assim, porém alteramos isto recentemente.</p>

<p>A idea da divisão de código é gerar vários pequenos bundles, normalmente um por rota/página e outro bundle principal. O único bundle que é enviado para todos os usuários é o principal, que tem como objetivo carregar os outros bundles menos baseados para poderar renderizar as páginas necessárias.</p>

<p>Parece complicado, mas graças ao React e Webpack, o processo ficou mais simples. Para quem usa React &lt;= 16.5, recomendamos o <a href="https://github.com/jamiebuilds/react-loadable">react-loadable</a>. Mas se você já está no React 16.6 ou mais recente, então é possível usar <code class="language-plaintext highlighter-rouge">React.lazy()</code> que foi recentemente adicionado.</p>

<ul>
  <li>Nesta PR você consegue ver como <a href="https://github.com/cfilby">@cfilby</a> (obrigado!) adicionou divisão de código no Fider com react-loadable: <a href="https://github.com/getfider/fider/pull/596">PR #596</a></li>
  <li>Depois de migrar para React 16.6, trocamos a dependência externa por React.lazy <a href="https://github.com/getfider/fider/pull/646">PR #646</a></li>
</ul>

<p>Também tivemos alguns raros problemas onde os visitantes estavam tendo dificuldades de baixar os bundles de forma assíncrona. A solução que implementamos foi documentada aqui <a href="https://goenning.net/2018/11/16/como-repetir-quando-react-lazy-falha/">Como repetir quando React Lazy falha</a>.</p>

<h2 id="carregando-dependências-externas-por-demanda">Carregando dependências externas por demanda</h2>

<p>Usando Webpack Bundle Analyzer, descobrimos que nosso vendor bundle continha todo o conteúdo do react-toastify, a biblioteca de mensagens/popups que usamos. Isto geralmente é esperado, mas no Fider, 95% nunca irão ver uma mensagem desta, afinal, existe pouquíssimos lugares em que mostramos estas mensagens. <strong>Por que enviamos 30kB de JavaScript para todos os visitantes se eles não vão usar?</strong></p>

<p>Este problema é similar ao de cima, exceto que não estamos mais falando de rotas/páginas, e sim de uma funcionalidade que é usada em diversas páginas. É possível fazer  divisão de código no nível de funcionalidade?</p>

<p>Sim, é possível! Também não é tão complicado 😀</p>

<p>Basta trocar a importação do módulo de estático para dinâmico. Ficaria assim:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// antes</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">toast</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./toastify</span><span class="dl">"</span><span class="p">;</span>
<span class="nx">toast</span><span class="p">(</span><span class="dl">"</span><span class="s2">Olá Mundo</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// depois</span>
<span class="k">import</span><span class="p">(</span><span class="dl">"</span><span class="s2">./toastify</span><span class="dl">"</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">module</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">module</span><span class="p">.</span><span class="nx">toast</span><span class="p">(</span><span class="dl">"</span><span class="s2">Olá Mundo</span><span class="dl">"</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>O Webpack fará o bundle do <code class="language-plaintext highlighter-rouge">toastify</code> e todas as suas dependências do NPM de forma separada. <strong>O navegador só baixará este bundle quando o código for executado</strong>. E case você tenha configurado o cache de longa duração, na segunda vez que este código for executado não será necessário baixar o bundle novamente.</p>

<p>Este vídeo mostra o comportamento disto no navegador.</p>

<p><img src="/public/images/2018/11/bundle-size-async-toastify.gif" alt="" /></p>

<p>Você pode encontrar mais detalhes de como isto foi implementado nesta <a href="https://github.com/getfider/fider/pull/645">PR #645</a></p>

<h2 id="font-awesome-e-tree-shaking">Font Awesome e Tree Shaking</h2>

<p>Tree Shaking é o processo de importar somente o código que vamos usar e descartar o resto. Isto é habilitado por padrão quando usamos Webpack no modo de produção.</p>

<p>A forma tradicionar de usar Font Awesome é importar um arquivo CSS externo (que por sua vez referência outras Fontes). Este CSS faz uma mapa de cada ícone para uma classe CSS. O resultado e que apesar de nossas aplicações usarem apenas os ícones A, B e C, estamos forçando os navegadores a baixarem mais de 600 ícones sem necessidade.</p>

<p>Depois de algum tempo procurando, achamos o <strong>react-icons</strong>, um pacote NPM que possuí todas os ícones do Font Awesome e de outras fontes também. Os ícones estã no format de SVG e são exportados como componentes React no format ES6 Module.</p>

<p>Isto significa que é possível importar apenas os ícones que precisamos, assim o webpack consegue remover todos os outros ícones que não são necessários. O resultado? <strong>Nosso CSS ficou 68kB menor</strong>. Sem contar que agora não é necessário fazer download de fontes externas também. Esta alteração foi o maior contribuinte para a redução do CSS no Fider.</p>

<p>Quer saber como fizemos? Veja esta <a href="https://github.com/getfider/fider/pull/631">PR #631</a></p>

<h2 id="trocando-grandes-pacotes-npm-por-opções-menores">Trocando grandes pacotes NPM por opções menores</h2>

<blockquote>
  <p>“NPM é como uma grande loja de lego, cheia de peças de montar disponíveis para você escolher. Você não paga pelo pacote que é instalado, mas seus usuários pagam pelos bytes que isto adicionado à sua aplicação. Escolha cuidadosamente.” - @goenning</p>
</blockquote>

<p>Novamente usando o Webpack Bundle Analyzer, descobrimos que o pacote <code class="language-plaintext highlighter-rouge">markdown-it</code> sozinho representava 40% do nosso vendor bundle. Decidimos então procurar no NPM por outra alternativa. O objetivo era achar um pacote que fosse menor, com desenvolvimento ativo e tivesse todas as funcionalidades que precisávamos.</p>

<p>Usamos bastante o <a href="https://bundlephobia.com/">bundlephobia.com</a> para analisar o tamanho total dos pacotes NPM. Encontramos então o <code class="language-plaintext highlighter-rouge">marked</code>, que <strong>reduziu nosso vendor bundle em 63kb</strong> com uma alteração mínima no nosso código.</p>

<p>Está curioso? Veja esta <a href="https://github.com/getfider/fider/pull/643">PR #643</a>.</p>

<p>Você também pode comparar este dois pacotes no bundlephobia</p>

<ul>
  <li><a href="https://bundlephobia.com/result?p=marked@0.5.2">https://bundlephobia.com/result?p=marked@0.5.2</a></li>
  <li><a href="https://bundlephobia.com/result?p=markdown-it@8.4.2">https://bundlephobia.com/result?p=markdown-it@8.4.2</a></li>
</ul>

<p>Pense duas vezes antes de adicionar um pacote. Você realmente precisa dele? Será que não é possível implementar uma alternativa mais simples? Será que tem algum outro pacote que faz o mesmo trabalho com menos bytes? Caso contrário, você também pode optar por adicionar este pacote e carregá-lo sob demanda como fizemos com o react-toastify mencionado acima.</p>

<h2 id="otimizando-o-bundle-principal-é-crucial">Otimizando o bundle principal é crucial</h2>

<p>Imagine que sua aplicação faz a divisão de codigo por rotas. A aplicação já está em produção e você faz uma alteraçao no componente <code class="language-plaintext highlighter-rouge">Dashboard</code>. Você acha que o Webpack gerará um novo bundle somente para o <code class="language-plaintext highlighter-rouge">Dashboard</code>?</p>

<p>Não é exatamente isto o que acontece.</p>

<p>O Webpack <strong>sempre</strong> vai regerar o bundle principal se qualquer outra parte da sua aplicação for alteradas. O motivo disto e que o bundle principal serve como um ponteiro para todos os outros bundles menores. Se o nome de um destes arquivos é alterado, o bundle principal tambem deve ser alterado com a nova referência dos outros bundles. Faz sentido, não é?</p>

<p>Então se seu bundle principal possui não apenas os ponteiros, mas também muito código como componentes básicos e outras funções, você está forçando o navegador a baixar tudo isto novamente.</p>

<p>Use o webpack bundle analyzer para entender o que faz parte do seu bundle principal e então aplique as técnicas apresentadas acima para remover (ou mover) o máximo possível de código.</p>

<h2 id="tslib-apenas-para-usuários-de-typescript">TSLib (apenas para usuários de TypeScript)</h2>

<p>Quando compilamos código TypeScript para ES5, o compilador do TypeSript emite algunas funções de ajuda (helper functions) em cada arquivo JavaScript. Este processo garante que o código escrito em TypeScript funcionará em navegadores mais antigos que não suportam funcionalidades do ES6, como por exemplo, Classes e Generators.</p>

<p>Estas funções de ajuda são bem pequenas, mas a quantidade delas se multiplica baseado na quantidade de arquivos TypeScript de seu projeto. O Webpack não consegue fazer o tree shaking disto e o resultado é um bundle com dezenas (ou centenas) de funções dupicadas. Seu bundle acabe de ficar maior do que o necessário.</p>

<p>O próprio TypeScript possui uma solução para isto. Existe um pacote NPM chamado de <strong>tslib</strong> que contém todas estas funções de ajuda que o TypeScript precisa. Podemos instruir o compilador a usar as funções deste pacotes ao invés de emitir este código nos arquivos JavaScript.</p>

<p>Para configurar isto, basta instalar o pacote com <strong>npm install tslib —save</strong> e alterar o <strong>tsconfig.json</strong> e incluir a configuração <strong>importHelpers: true</strong>.</p>

<p>Isto é tudo!</p>

<p>A quantidade de bytes que isto reduzirá dependente da quantidade de arquivos TypeScript que usam código ES6, o que pode ser bastante em um projeto React.</p>

<h2 id="o-próximo-bilhão-de-usuários">O próximo bilhão de usuários</h2>

<p>você está pronto para o <a href="https://developers.google.com/web/billions/">próximo bilhão de usuários</a>? Imagine todos os potenciais usuários de sua aplicação que hoje possuem dificuldade de usá-la em um dispositivo inferior ou com uma conexão de internet precária.</p>

<p>Reduzir o tamanho dos bundles possui um impacto direto no desempenho das aplicação e isto as torna mais acessíveis para todo mundo. Espero que este post te ajude nesta jornada.</p>

<p>Um abraço.</p>

  </div>
  <a href="https://twitter.com/intent/tweet?text=Como+reduzimos+o+tamanho+inicial+do+JS+e+CSS+em+67%25+by+@goenning&url=https%3A%2F%2Fgoenning.net%2F2018%2F11%2F26%2Fcomo-reduzimos-tamanho-inicial-js-css%2F">Discuss on Twitter</a> <small>•</small> <a href="https://github.com/goenning/goenning.github.io/tree/master/_posts/2018/2018-11-26-como-reduzimos-tamanho-inicial-js-css.md">Edit on GitHub</a>
</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          <a href="mailto:me@goenning.net" aria-label="Email" target="_blank" rel="noopener"><i class="svg-icon email"></i></a>
<a href="https://github.com/goenning" aria-label="GitHub" target="_blank" rel="noopener"><i class="svg-icon github"></i></a>
<a href="https://www.linkedin.com/in/goenning" aria-label="LinkedIn" target="_blank" rel="noopener"><i class="svg-icon linkedin"></i></a>
<a href="/feed.xml" aria-label="RSS Feed" target="_blank" rel="noopener"><i class="svg-icon rss"></i></a>
<a href="https://www.twitter.com/goenning" aria-label="Twitter" target="_blank" rel="noopener"><i class="svg-icon twitter"></i></a>




        </footer>
      </div>
    </div>
  </body>
</html>
