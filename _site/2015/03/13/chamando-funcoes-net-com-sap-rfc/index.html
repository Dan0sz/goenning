<!DOCTYPE html>
<html lang="pt">
  <head>
    <title>Chamando funções .NET com SAP RFC – @goenning</title>

    <meta charset="utf-8" />
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" type="text/css" href="/style.css" />  <!-- Icons -->
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="alternate" type="application/rss+xml" title="@goenning - loop at { run; code; blog; swim; eat; cycle; } until tired;" href="/feed.xml" />
    

    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Chamando funções .NET com SAP RFC | @goenning</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Chamando funções .NET com SAP RFC" />
<meta name="author" content="@goenning" />
<meta property="og:locale" content="pt" />
<meta name="description" content="No post Conectando o mundo externo ao SAP com o uso de RFC falamos sobre como fazer aplicações Java e .NET acessarem funções do SAP através do protocolo RFC." />
<meta property="og:description" content="No post Conectando o mundo externo ao SAP com o uso de RFC falamos sobre como fazer aplicações Java e .NET acessarem funções do SAP através do protocolo RFC." />
<link rel="canonical" href="https://goenning.net/2015/03/13/chamando-funcoes-net-com-sap-rfc/" />
<meta property="og:url" content="https://goenning.net/2015/03/13/chamando-funcoes-net-com-sap-rfc/" />
<meta property="og:site_name" content="@goenning" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-03-13T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Chamando funções .NET com SAP RFC" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"@goenning"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://goenning.net/2015/03/13/chamando-funcoes-net-com-sap-rfc/"},"@type":"BlogPosting","description":"No post Conectando o mundo externo ao SAP com o uso de RFC falamos sobre como fazer aplicações Java e .NET acessarem funções do SAP através do protocolo RFC.","headline":"Chamando funções .NET com SAP RFC","dateModified":"2015-03-13T00:00:00-05:00","url":"https://goenning.net/2015/03/13/chamando-funcoes-net-com-sap-rfc/","datePublished":"2015-03-13T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/pt" class="site-avatar"><img width="70" height="70" alt="@goenning" src="https://avatars.githubusercontent.com/u/94755?s=210" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/pt">@goenning</a></h1>
            <p class="site-description">loop at { run; code; blog; swim; eat; cycle; } until tired;</p>
          </div>

          <nav>
            
              <a href="/pt">Blog</a>
            
              <a href="/arquivo">Arquivo</a>
            
              <a href="/projetos">Projetos</a>
            

            <div class="langs">
              
              
              
              
              
              <a href="/pt" title="Português" class="flag">
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 480" height="100%" width="100%">
  <g stroke-width="1pt">
    <path fill-rule="evenodd" fill="#229e45" d="M0 0h640v480H0z"/>
    <path d="M321.406 435.935l301.483-195.67-303.308-196.2L17.11 240.734l304.296 195.2z" fill-rule="evenodd" fill="#f8e509"/>
    <path d="M452.77 240.005c0 70.328-57.103 127.34-127.544 127.34-70.442 0-127.544-57.012-127.544-127.34s57.104-127.34 127.544-127.34c70.442 0 127.545 57.012 127.545 127.34z" fill-rule="evenodd" fill="#2b49a3"/>
    <path fill="#ffffef" fill-rule="evenodd" d="M283.3 316.274L279.357 314l-4.093 2.025.917-4.55-3.162-3.332 4.52-.53 2.124-4.08 1.894 4.22 4.46.81-3.345 3.13M368.77 337.917l-3.94-2.274-4.092 2.025.916-4.55-3.16-3.332 4.52-.53 2.122-4.08 1.894 4.22 4.46.81-3.345 3.13M331.93 303.343l-3.404-1.964-3.536 1.748.792-3.93-2.73-2.88 3.904-.457 1.834-3.523 1.636 3.645 3.853.7-2.89 2.705M418.254 290.91l-3.342-1.928-3.472 1.718.777-3.858-2.68-2.827 3.833-.45 1.8-3.46 1.607 3.58 3.783.686-2.837 2.657M330.37 265.03l-3.94-2.273-4.093 2.025.916-4.55-3.162-3.332 4.522-.53 2.123-4.08 1.894 4.22 4.46.81-3.346 3.13M225.13 225.52l-3.94-2.274-4.094 2.025.916-4.548-3.16-3.333 4.52-.53 2.122-4.08 1.894 4.22 4.46.81-3.345 3.13M237.786 278.08l-3.94-2.275-4.094 2.025.916-4.548-3.16-3.334 4.52-.53 2.123-4.08 1.894 4.22 4.46.81-3.345 3.132M369.114 206.17l-3.48-2.007-3.616 1.788.81-4.017-2.794-2.944 3.994-.47 1.875-3.603 1.673 3.728 3.94.715-2.955 2.766M361.896 240.366l-2.74-1.582-2.85 1.408.64-3.164-2.2-2.32 3.145-.368 1.477-2.838 1.318 2.936 3.103.563-2.327 2.18M219.263 287.603l-2.63-1.518-2.734 1.352.61-3.037-2.11-2.225 3.02-.354 1.416-2.723 1.264 2.818 2.978.54-2.233 2.09M418.984 299.71l-2.144-1.135-2.227 1.01.5-2.27-1.72-1.666 2.46-.265 1.154-2.038 1.03 2.108 2.426.404-1.82 1.563"/>
    <path fill="#ffffef" fill-rule="evenodd" d="M219.263 287.603l-2.63-1.518-2.734 1.352.61-3.037-2.11-2.225 3.02-.354 1.416-2.723 1.264 2.818 2.978.54-2.233 2.09"/>
    <path fill="#ffffef" fill-rule="evenodd" d="M219.263 287.603l-2.63-1.518-2.734 1.352.61-3.037-2.11-2.225 3.02-.354 1.416-2.723 1.264 2.818 2.978.54-2.233 2.09M261.143 287.594l-2.63-1.52-2.733 1.353.61-3.037-2.11-2.225 3.02-.354 1.416-2.722 1.265 2.817 2.978.54-2.233 2.09M255.94 301.525l-2.63-1.518-2.734 1.352.612-3.038-2.11-2.225 3.017-.354 1.417-2.724 1.265 2.817 2.977.54-2.233 2.09M342.902 276.164l-2.63-1.52-2.733 1.353.61-3.036-2.11-2.225 3.018-.353 1.417-2.724 1.265 2.817 2.977.54-2.233 2.09M317.384 276.154l-2.63-1.518-2.734 1.352.612-3.037-2.11-2.225 3.018-.353 1.417-2.724 1.264 2.817 2.98.54-2.234 2.09M248.167 267.258l-1.648-.952-1.714.847.384-1.902-1.323-1.394 1.89-.222.89-1.706.792 1.765 1.864.34-1.4 1.31M415.74 310.728l-2.63-1.518-2.733 1.35.612-3.035-2.11-2.226 3.017-.354 1.417-2.724 1.264 2.817 2.978.54-2.233 2.09M394.49 313.512l-2.178-1.26-2.264 1.122.507-2.522-1.748-1.848 2.5-.294 1.174-2.262 1.048 2.34 2.466.45-1.85 1.735M404.516 313.27l-2.03-1.173-2.108 1.044.472-2.344-1.63-1.718 2.33-.274 1.093-2.103.976 2.177 2.296.417-1.723 1.615M433.302 288.15l-1.955-1.13-2.03 1.006.454-2.257-1.567-1.655 2.243-.262 1.053-2.024.94 2.092 2.21.402-1.658 1.553M394.24 327.69l-2.554-1.395-2.652 1.24.594-2.786-2.05-2.043 2.93-.325 1.376-2.5 1.227 2.586 2.89.496-2.167 1.92M394.383 339.13l-2.33-1.395-2.418 1.24.542-2.786-1.87-2.044 2.673-.324 1.255-2.5 1.12 2.586 2.635.496-1.977 1.918M375.084 313.266l-1.955-1.13-2.032 1.006.455-2.257-1.568-1.653 2.242-.263 1.054-2.025.94 2.093 2.213.402-1.66 1.554M356.992 313.266l-1.954-1.13-2.03 1.006.454-2.257-1.57-1.653 2.244-.263 1.053-2.025.94 2.093 2.21.402-1.658 1.554M326.273 286.403l-1.955-1.128-2.03 1.004.454-2.257-1.568-1.654 2.243-.264 1.053-2.024.94 2.094 2.212.402-1.66 1.553M329.696 341.153l-1.656-.956-1.72.85.386-1.91-1.33-1.4 1.9-.223.893-1.715.795 1.772 1.874.34-1.407 1.316M283.3 252.597l-3.942-2.274-4.093 2.025.917-4.548-3.162-3.334 4.52-.53 2.124-4.08 1.894 4.22 4.46.81-3.345 3.132"/>
    <path d="M444.368 285.817c1.944-5.083 4.45-12.75 5.783-19.786-67.742-59.508-143.26-89.993-238.68-83.72-3.422 6.558-6.16 13.423-8.47 20.853 113.063-10.786 195.936 39.27 241.37 82.654z" fill-rule="evenodd" fill="#fff"/>
    <path d="M413.914 252.36l2.42 1.323c-.38.858-.48 1.61-.31 2.25.18.645.625 1.208 1.335 1.688.75.515 1.424.74 2.016.68.6-.06 1.045-.306 1.335-.734.183-.274.258-.563.225-.863-.027-.3-.192-.66-.495-1.075-.21-.28-.72-.873-1.53-1.777-1.04-1.16-1.66-2.138-1.86-2.936-.28-1.122-.11-2.14.51-3.06.4-.59.936-1.03 1.612-1.318.686-.29 1.433-.355 2.24-.198.81.157 1.664.54 2.55 1.143 1.453.987 2.33 2.048 2.63 3.184.305 1.138.117 2.253-.565 3.345l-2.404-1.484c.3-.665.375-1.24.218-1.723-.147-.485-.55-.95-1.21-1.397-.676-.46-1.302-.682-1.874-.663-.37.01-.654.168-.856.468-.186.277-.228.59-.13.943.13.45.668 1.193 1.625 2.234.953 1.04 1.604 1.89 1.95 2.547.355.657.516 1.34.482 2.05-.023.706-.284 1.427-.778 2.16-.45.667-1.053 1.163-1.812 1.493-.76.33-1.57.412-2.437.24-.86-.177-1.794-.607-2.798-1.29-1.462-.992-2.36-2.093-2.687-3.3-.322-1.213-.125-2.523.6-3.925zM402.436 244.827l2.472 1.22c-.345.872-.417 1.628-.22 2.26.208.637.672 1.183 1.4 1.635.775.482 1.455.68 2.043.596.6-.086 1.037-.346 1.306-.786.174-.28.236-.573.19-.87-.038-.302-.218-.655-.54-1.058-.22-.272-.75-.84-1.597-1.713-1.087-1.117-1.746-2.07-1.978-2.86-.323-1.11-.194-2.133.385-3.077.378-.606.896-1.066 1.56-1.38.674-.316 1.42-.413 2.23-.29.818.127 1.685.473 2.595 1.04 1.492.926 2.408 1.952 2.753 3.074.35 1.126.21 2.247-.427 3.365l-2.464-1.385c.275-.676.327-1.252.15-1.728-.168-.482-.59-.93-1.264-1.35-.697-.433-1.33-.628-1.9-.586-.37.025-.647.195-.838.504-.172.282-.204.594-.09.944.145.443.714 1.165 1.71 2.168.994 1 1.68 1.822 2.052 2.465.38.64.568 1.318.563 2.027.007.708-.227 1.437-.69 2.193-.42.68-1.008 1.202-1.75 1.565-.746.36-1.556.474-2.427.336-.865-.14-1.815-.536-2.848-1.175-1.498-.933-2.438-1.996-2.815-3.19-.374-1.2-.23-2.514.438-3.943zM388.23 241.02l7.276-11.966 8.837 5.416-1.23 2.026-6.43-3.942-1.615 2.652 5.983 3.668-1.225 2.015-5.984-3.667-1.977 3.256 6.657 4.08-1.228 2.017-9.063-5.557zM367.538 224.027l1.08-2.1 5.4 2.796-2.546 4.962c-.79.238-1.78.296-2.982.17-1.19-.13-2.295-.457-3.317-.986-1.3-.673-2.29-1.528-2.976-2.572-.683-1.05-1.01-2.205-.974-3.47.04-1.274.363-2.507.977-3.703.664-1.298 1.53-2.31 2.59-3.04 1.057-.727 2.25-1.09 3.57-1.09 1.008-.002 2.104.306 3.29.916 1.542.8 2.577 1.747 3.104 2.846.54 1.096.638 2.28.298 3.555l-2.728-.82c.14-.702.057-1.356-.25-1.957-.296-.606-.806-1.095-1.527-1.47-1.097-.567-2.146-.67-3.155-.305-1 .363-1.85 1.23-2.554 2.6-.76 1.48-1.005 2.76-.73 3.842.277 1.073.944 1.886 2.008 2.437.524.27 1.1.44 1.73.507.64.066 1.22.05 1.753-.05l.81-1.582-2.872-1.485zM277.296 201.648l2.034-13.867 4.172.62 1.123 9.826 3.86-9.093 4.188.618-2.033 13.87-2.59-.382 1.6-10.918-4.343 10.512-2.685-.398-1.134-11.32-1.6 10.915-2.592-.382zM263.188 200.01l1.305-13.96 10.307.974-.217 2.36-7.503-.706-.29 3.095 6.978.657-.22 2.352-6.98-.658-.353 3.8 7.764.73-.22 2.354-10.572-.998z" fill="#309e3a"/>
    <g stroke-opacity=".502">
      <path d="M216.5 191.28c.04-1.43.284-2.62.736-3.58.335-.703.786-1.332 1.346-1.884.566-.552 1.18-.956 1.844-1.21.88-.347 1.888-.505 3.023-.475 2.056.06 3.682.744 4.877 2.057 1.205 1.315 1.775 3.114 1.714 5.395-.06 2.26-.72 4.017-1.982 5.264-1.26 1.24-2.914 1.834-4.963 1.777-2.077-.056-3.708-.736-4.9-2.037-1.19-1.308-1.755-3.078-1.694-5.307z" fill="#309e3a"/>
      <path d="M219.414 191.252c-.043 1.586.29 2.8.997 3.643.708.837 1.625 1.27 2.748 1.3 1.122.03 2.055-.35 2.794-1.138.745-.797 1.14-2.007 1.184-3.633.043-1.605-.277-2.813-.96-3.622-.676-.81-1.595-1.23-2.757-1.262-1.162-.03-2.11.345-2.843 1.128-.733.777-1.12 1.972-1.163 3.584z" fill="#f7ffff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M233.052 198.51l.163-14.017 5.933.07c1.494.018 2.574.157 3.244.42.677.257 1.214.71 1.613 1.36s.593 1.385.584 2.215c-.013 1.052-.332 1.918-.956 2.598-.623.675-1.55 1.095-2.777 1.26.605.363 1.104.76 1.49 1.193.397.43.923 1.195 1.585 2.293l1.673 2.754-3.372-.04-2.002-3.074c-.71-1.098-1.198-1.788-1.46-2.072-.265-.29-.545-.487-.842-.593-.297-.11-.77-.17-1.418-.177l-.57-.008-.068 5.852-2.82-.033z" fill="#309e3a"/>
      <path d="M235.976 190.455l2.086.024c1.353.016 2.198-.03 2.536-.142.337-.112.603-.305.796-.584s.293-.627.3-1.048c.004-.472-.118-.853-.37-1.142-.243-.296-.594-.486-1.05-.567-.23-.034-.915-.06-2.057-.072l-2.2-.026-.04 3.555z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M249.003 185.188l5.147.26c1.16.06 2.04.195 2.64.405.804.283 1.484.75 2.036 1.396.553.646.958 1.426 1.218 2.34.26.907.356 2.015.29 3.326-.058 1.153-.252 2.138-.58 2.96-.4 1-.938 1.797-1.618 2.396-.51.453-1.19.79-2.034 1.016-.632.166-1.468.222-2.51.17l-5.295-.27.706-14z" fill="#309e3a"/>
      <path d="M251.706 187.685l-.468 9.274 2.103.105c.786.042 1.357.025 1.71-.046.46-.093.85-.268 1.16-.526.32-.26.59-.695.81-1.31.223-.62.36-1.47.416-2.553s0-1.918-.16-2.507c-.16-.59-.404-1.053-.73-1.397-.327-.342-.75-.583-1.27-.724-.39-.11-1.157-.193-2.306-.25l-1.264-.067z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M317.63 210.22l3.26-13.63 4.4 1.06c1.666.402 2.737.732 3.21.99.73.392 1.274.996 1.634 1.81.36.81.41 1.755.152 2.84-.2.836-.518 1.504-.958 2-.438.5-.932.854-1.48 1.07-.54.212-1.064.31-1.57.3-.685-.028-1.65-.19-2.89-.49l-1.786-.432-1.23 5.142-2.743-.66z" fill="#309e3a"/>
      <path d="M323.086 199.552l-.926 3.868 1.5.362c1.082.26 1.82.364 2.218.308.4-.055.736-.21 1.013-.464.283-.253.473-.58.568-.984.12-.496.073-.94-.14-1.33-.214-.395-.533-.684-.957-.87-.312-.143-.96-.332-1.95-.57l-1.324-.32z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M330.606 214.106l4.64-13.22 5.598 1.98c1.408.498 2.387.98 2.937 1.445.56.463.923 1.064 1.093 1.807s.12 1.505-.156 2.286c-.348.992-.928 1.71-1.736 2.153-.806.438-1.817.537-3.032.298.457.54.802 1.076 1.03 1.61.238.536.49 1.43.765 2.683l.704 3.15-3.18-1.126-.913-3.556c-.322-1.27-.562-2.08-.72-2.435-.158-.36-.36-.638-.607-.834-.246-.202-.673-.41-1.286-.627l-.536-.192-1.938 5.52-2.66-.942z" fill="#309e3a"/>
      <path d="M335.938 207.426l1.967.695c1.276.452 2.09.68 2.445.683.355.005.67-.093.943-.295.272-.2.478-.5.616-.896.155-.445.162-.845.017-1.2-.135-.36-.408-.65-.813-.876-.206-.106-.847-.35-1.924-.73l-2.075-.736-1.177 3.356z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M347.01 213.6c.424-1.363.982-2.444 1.673-3.24.517-.59 1.117-1.072 1.808-1.45.696-.377 1.397-.598 2.102-.665.94-.093 1.953.03 3.038.37 1.965.614 3.344 1.717 4.14 3.308.803 1.593.867 3.48.19 5.658-.67 2.162-1.78 3.67-3.33 4.528-1.548.852-3.302.97-5.26.357-1.982-.62-3.37-1.718-4.164-3.294-.793-1.583-.858-3.44-.196-5.57z" fill="#309e3a"/>
      <path d="M349.826 214.385c-.47 1.514-.48 2.773-.026 3.778.455.996 1.22 1.663 2.293 2 1.073.334 2.07.223 2.996-.336.932-.562 1.64-1.62 2.122-3.172.476-1.535.495-2.783.056-3.75-.432-.962-1.204-1.618-2.313-1.964-1.11-.347-2.123-.243-3.04.312-.915.548-1.61 1.592-2.09 3.133z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M374.305 233.12l6.415-12.45 5.27 2.736c1.326.69 2.23 1.3 2.71 1.84.49.532.768 1.18.835 1.94s-.092 1.505-.47 2.242c-.48.934-1.153 1.564-2.017 1.892-.86.322-1.872.28-3.043-.128.378.598.645 1.18.8 1.74.158.564.288 1.484.387 2.763l.262 3.215-2.993-1.555-.415-3.648c-.145-1.304-.27-2.14-.378-2.512-.105-.377-.27-.682-.487-.91-.214-.233-.61-.5-1.186-.798l-.507-.264-2.677 5.197-2.505-1.3z" fill="#309e3a"/>
      <path d="M380.503 227.226l1.853.962c1.2.625 1.977.962 2.33 1.016.35.054.675 0 .973-.162.296-.16.54-.428.733-.803.216-.42.276-.814.184-1.186-.087-.374-.315-.702-.685-.98-.19-.134-.79-.465-1.808-.993l-1.952-1.013-1.63 3.16z" fill="#fff"/>
    </g>
    <g stroke-opacity=".502">
      <path d="M426.107 258.704c.797-1.183 1.642-2.056 2.536-2.62.662-.412 1.377-.7 2.146-.862.774-.16 1.507-.168 2.2-.028.93.184 1.864.596 2.805 1.235 1.704 1.156 2.708 2.612 3.014 4.366.31 1.758-.173 3.58-1.448 5.472-1.263 1.873-2.758 2.998-4.488 3.37-1.728.365-3.44-.028-5.14-1.182-1.718-1.168-2.732-2.622-3.04-4.362-.303-1.746.168-3.543 1.413-5.39z" fill="#309e3a"/>
      <path d="M428.578 260.254c-.886 1.316-1.256 2.518-1.112 3.61.15 1.087.69 1.945 1.62 2.578.932.632 1.92.815 2.967.55 1.055-.27 2.037-1.077 2.944-2.425.896-1.33 1.273-2.52 1.13-3.572-.138-1.047-.688-1.898-1.65-2.552s-1.962-.85-3-.583c-1.033.26-1.998 1.06-2.9 2.394z" fill="#fff"/>
    </g>
    <path d="M301.824 204.523l2.248-9.84 7.268 1.675-.378 1.662-5.287-1.217-.504 2.18 4.926 1.136-.382 1.655-4.918-1.132-.614 2.677 5.475 1.26-.378 1.66-7.456-1.717z" fill="#309e3a"/>
  </g>
</svg>

              </a>
              <a href="/" title="English" class="flag">
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 480" height="100%" width="100%">
  <defs>
    <clipPath id="a">
      <path fill-opacity=".67" d="M-85.333 0h682.67v512h-682.67z"/>
    </clipPath>
  </defs>
  <g clip-path="url(#a)" transform="matrix(.94 0 0 .94 80 0)">
    <g stroke-width="1pt">
      <path fill="#006" d="M-256 0H768.02v512.01H-256z"/>
      <path d="M-256 0v57.244l909.535 454.768H768.02V454.77L-141.515 0H-256zM768.02 0v57.243L-141.515 512.01H-256v-57.243L653.535 0H768.02z" fill="#fff"/>
      <path d="M170.675 0v512.01h170.67V0h-170.67zM-256 170.67v170.67H768.02V170.67H-256z" fill="#fff"/>
      <path d="M-256 204.804v102.402H768.02V204.804H-256zM204.81 0v512.01h102.4V0h-102.4zM-256 512.01L85.34 341.34h76.324l-341.34 170.67H-256zM-256 0L85.34 170.67H9.016L-256 38.164V0zm606.356 170.67L691.696 0h76.324L426.68 170.67h-76.324zM768.02 512.01L426.68 341.34h76.324L768.02 473.848v38.162z" fill="#c00"/>
    </g>
  </g>
</svg>

              </a>
            </div>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>Chamando funções .NET com SAP RFC</h1>

  <small>
    


  13 de
  Março
      
  de 2015

    


  
    • 10 minutos para ler
  

    • 
  <a href="/tags/pt#abap">abap</a>

  </small>

  <div class="entry">
    <p>No post <a href="/2015/03/13/conectando-o-mundo-externo-ao-sap-com-o-uso-de-rfc/">Conectando o mundo externo ao SAP com o uso de RFC</a> falamos sobre como fazer aplicações Java e .NET acessarem funções do SAP através do protocolo RFC.</p>

<p>Algo que me parece pouco comum — porém com grande potencial e utilidade — é a possibilidade de fazer um programa ABAP invocar métodos escritos em Java ou .NET usando este mesmo protocolo. Aprendemos no post acima que quando invocamos uma função através de <strong>CALL FUNCTION</strong> é possível definir um destinatário RFC. Qualquer servidor de aplicação ABAP pode ser cadastrado como um destinatários RFC — e é por isto que é possível fazer chamadas remotas entre servidores ABAP. As bibliotecas <strong>JCo</strong> e <strong>NCo</strong> permitem que nós criemos um servidor RFC que também pode ser usado como um destinatário.</p>

<p>Neste post vamos ver um passo a passo de como fazer isto. Vamos usar como exemplo um programa ABAP que lista os repositórios públicos do GitHub de um usuário através de um método escrito em .NET.</p>

<p><img src="/public/images/2015/03/sap-github-nco.png" alt="" /></p>

<h2 id="criando-um-destinatário-rfc">Criando um destinatário RFC</h2>

<p>O primeiro passo é criar uma nova entrada na transação SM59 com o tipo de conexão <strong>T</strong> (TCP/IP Connection).</p>

<p>No meu caso chamei o destinatário de DOTNET_SERVER, marquei a opção “Registered Server Program” e usei o mesmo nome no PROGRAM ID.</p>

<p>Qual a diferença entre estes dois campos? O nome do destinatário é o nome usado no ABAP nas chamadas ‘CALL FUNCTION <nome-da-funcao> DESTINATION <DOTNET_SERVER>&#8217;, enquanto o PROGRAM ID é um token de correlação com o servidor que iremos criar em .NET. Voltaremos a falar dele mais a diante.</DOTNET_SERVER></nome-da-funcao></p>

<p>Informei também o host e o serviço do <strong><a href="http://help.sap.com/saphelp_nw73/helpdata/en/31/42f34a7cab4cb586177f85a0cf6780/frameset.htm">SAP Gateway</a></strong> presente em meu ambiente MiniSAP. Toda instância ABAP possui um Gateway que é responsável pela comunicação RFC.</p>

<p>Veja como ficou o cadastro.</p>

<p><img src="/public/images/2015/03/rfc-destination.png" alt="" /></p>

<h2 id="criar-a-função-abap">Criar a função ABAP</h2>

<p>Por mais que a função será executada somente no sistema remoto, precisamos entrar na transação SE37 e criar o esqueleto da função, isto é, informar quais serão os parâmetros de entrada e saída. O servidor remoto utiliza esta estrutura da função para gerar os metadados necessários para que o SAP Connector funcione.</p>

<p>A nossa função vai se chamar <strong>LIST_GITHUB_REPO</strong>. Ela recebe o usuário por parâmetro de entrada e retornar uma tabela de repositórios. Não é necessário inserir código fonte. Veja como ficou:</p>

<p><img src="/public/images/2015/03/fm_gh_repo.png" alt="" /></p>

<p><strong>Obs.:</strong> Não esquecer de habilitar a opção <strong>Remote-Enable Function</strong> na primeira aba.</p>

<p>Esta é a estrutura e a categoria de tabela que a função retorna:</p>

<p><img src="/public/images/2015/03/zstr_repo.png" alt="" /></p>

<h2 id="criando-nosso-servidor-rfc-em-net">Criando nosso servidor RFC em .NET</h2>

<p>O ideal é que seja criado um projeto do tipo <strong>Windows Service</strong> para que este possa ser instalado como serviço e iniciado automaticamente junto com o sistema operacional. Como isto aqui é apenas uma demonstração, vou criar um projeto Console que é mais fácil de executar e depurar caso necessário.</p>

<p>O primeiro passo é adicionar uma referência ao SAP NCo. Para isto estou usando o pacote <a href="https://www.nuget.org/packages/SAPNCo.x86/">SAPNCo.x86</a> do NuGet (também está disponível a versão <a href="https://www.nuget.org/packages/SAPNCo.x64/">x64</a> para quem se interessar). Também vamos precisar do pacote <a href="https://www.nuget.org/packages/Octokit/">Octokit</a> para fazer a consulta no GitHub.</p>

<p>Por baixo dos panos o que o Octokit faz é chamar a API pública do GitHub. Veja um exemplo dela em ação: <a href="https://api.github.com/users/goenning/repos">https://api.github.com/users/goenning/repos</a></p>

<p>No arquivo de configurações precisamos registrar dois elementos: <strong>Destination</strong> e <strong>Server</strong>.</p>

<ul>
  <li>O <strong>Destination</strong> contém as credenciais e parâmetros de acesso ao SAP para coleta de metadados. Esta configuração é mesma usada no exemplo anterior quando nosso aplicativo era apenas Client.</li>
  <li>O <strong>Server</strong> possui as configurações que nosso servidor vai usar para se registrar no Gateway de destino.</li>
</ul>

<p>O meu arquivo de configuração ficou assim.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;configSections&gt;</span>
    <span class="nt">&lt;sectionGroup</span> <span class="na">name=</span><span class="s">"SAP.Middleware.Connector"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;sectionGroup</span> <span class="na">name=</span><span class="s">"ClientSettings"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;section</span> <span class="na">name=</span><span class="s">"DestinationConfiguration"</span> <span class="na">type=</span><span class="s">"SAP.Middleware.Connector.RfcDestinationConfiguration, sapnco"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/sectionGroup&gt;</span>
      <span class="nt">&lt;sectionGroup</span> <span class="na">name=</span><span class="s">"ServerSettings"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;section</span> <span class="na">name=</span><span class="s">"ServerConfiguration"</span> <span class="na">type=</span><span class="s">"SAP.Middleware.Connector.RfcServerConfiguration, sapnco"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/sectionGroup&gt;</span>
    <span class="nt">&lt;/sectionGroup&gt;</span>
  <span class="nt">&lt;/configSections&gt;</span>

  <span class="nt">&lt;SAP.Middleware.Connector&gt;</span>

    <span class="nt">&lt;ClientSettings&gt;</span>
      <span class="nt">&lt;DestinationConfiguration&gt;</span>
        <span class="nt">&lt;destinations&gt;</span>
          <span class="nt">&lt;add</span> <span class="na">NAME=</span><span class="s">"TST"</span> <span class="na">USER=</span><span class="s">"bcuser"</span> <span class="na">PASSWD=</span><span class="s">"sapadmin2"</span> <span class="na">CLIENT=</span><span class="s">"001"</span>
               <span class="na">LANG=</span><span class="s">"EN"</span> <span class="na">ASHOST=</span><span class="s">"sap-vm"</span> <span class="na">SYSNR=</span><span class="s">"00"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/destinations&gt;</span>
      <span class="nt">&lt;/DestinationConfiguration&gt;</span>
    <span class="nt">&lt;/ClientSettings&gt;</span>

    <span class="nt">&lt;ServerSettings&gt;</span>
      <span class="nt">&lt;ServerConfiguration&gt;</span>
        <span class="nt">&lt;servers&gt;</span>
          <span class="nt">&lt;add</span> <span class="na">NAME=</span><span class="s">"DOTNET_SERVER"</span> <span class="na">GWHOST=</span><span class="s">"sap-vm"</span> <span class="na">GWSERV=</span><span class="s">"sapgw00"</span> <span class="na">PROGRAM_ID=</span><span class="s">"DOTNET_SERVER"</span> <span class="na">REPOSITORY_DESTINATION=</span><span class="s">"TST"</span> <span class="na">REG_COUNT=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/servers&gt;</span>
      <span class="nt">&lt;/ServerConfiguration&gt;</span>
    <span class="nt">&lt;/ServerSettings&gt;</span>

  <span class="nt">&lt;/SAP.Middleware.Connector&gt;</span>

  <span class="nt">&lt;startup&gt;</span>
    <span class="nt">&lt;supportedRuntime</span> <span class="na">version=</span><span class="s">"v4.0"</span> <span class="na">sku=</span><span class="s">".NETFramework,Version=v4.5"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/startup&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div></div>

<p>Lembram que falei do PROGRAM ID? Vejam que aqui estamos usando os mesmos valores que foram informamos na SM59 para os três parâmetros: <strong>PROGRAM_ID</strong>, <strong>GWHOST</strong> e <strong>GWSERV</strong>.</p>

<p>Vamos precisar de apenas duas classes:</p>

<ul>
  <li><strong>Program:</strong> O ponto de início da aplicação console. Responsável pela criação e inicialização do servidor RFC.</li>
  <li><strong>MyRfcHandler:</strong> Classe que conterá os métodos que são invocados remotamente.</li>
</ul>

<p>O código delas ficou assim:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Type</span><span class="p">[]</span> <span class="n">handlers</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Type</span><span class="p">[]</span> <span class="p">{</span> <span class="k">typeof</span><span class="p">(</span><span class="n">MyRfcHandler</span><span class="p">)</span> <span class="p">};</span>
        <span class="n">RfcServer</span> <span class="n">server</span> <span class="p">=</span> <span class="n">RfcServerManager</span><span class="p">.</span><span class="nf">GetServer</span><span class="p">(</span><span class="s">"DOTNET_SERVER"</span><span class="p">,</span> <span class="n">handlers</span><span class="p">);</span>
        <span class="n">server</span><span class="p">.</span><span class="n">RfcServerError</span> <span class="p">+=</span> <span class="n">RfcServer_OnError</span><span class="p">;</span>
        <span class="n">server</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Server running. Press key to stop…"</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
        <span class="n">server</span><span class="p">.</span><span class="nf">Shutdown</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RfcServer_OnError</span><span class="p">(</span><span class="kt">object</span> <span class="n">server</span><span class="p">,</span> <span class="n">RfcServerErrorEventArgs</span> <span class="n">errorEventData</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Error: "</span> <span class="p">+</span> <span class="n">errorEventData</span><span class="p">.</span><span class="n">Error</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>No caso de um projeto Windows Service este código deveria estar no método <strong>OnStart</strong> da classe de serviço.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">MyRfcHandler</span>
<span class="p">{</span> 
    <span class="p">[</span><span class="nf">RfcServerFunction</span><span class="p">(</span><span class="n">Name</span><span class="p">=</span><span class="s">"LIST_GITHUB_REPO"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">StfcConnection</span><span class="p">(</span><span class="n">RfcServerContext</span> <span class="n">myContext</span><span class="p">,</span> <span class="n">IRfcFunction</span> <span class="n">function</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">github</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GitHubClient</span><span class="p">(</span><span class="k">new</span> <span class="nf">ProductHeaderValue</span><span class="p">(</span><span class="s">"NCoSampleServer"</span><span class="p">));</span>

        <span class="kt">string</span> <span class="n">username</span> <span class="p">=</span> <span class="n">function</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="s">"USER"</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">task</span> <span class="p">=</span> <span class="n">github</span><span class="p">.</span><span class="n">Repository</span><span class="p">.</span><span class="nf">GetAllForUser</span><span class="p">(</span><span class="n">username</span><span class="p">);</span>
        <span class="n">task</span><span class="p">.</span><span class="nf">Wait</span><span class="p">();</span>

        <span class="n">IRfcTable</span> <span class="n">table</span> <span class="p">=</span> <span class="n">function</span><span class="p">.</span><span class="nf">GetTable</span><span class="p">(</span><span class="s">"REPOS"</span><span class="p">);</span>
        <span class="n">RfcStructureMetadata</span> <span class="n">structure</span> <span class="p">=</span> <span class="n">table</span><span class="p">.</span><span class="n">Metadata</span><span class="p">.</span><span class="n">LineType</span><span class="p">;</span><span class="k">public</span>
        <span class="k">foreach</span><span class="p">(</span><span class="n">Repository</span> <span class="n">repo</span> <span class="k">in</span> <span class="n">task</span><span class="p">.</span><span class="n">Result</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IRfcStructure</span> <span class="n">row</span> <span class="p">=</span> <span class="n">structure</span><span class="p">.</span><span class="nf">CreateStructure</span><span class="p">();</span>
            <span class="n">row</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="s">"ID"</span><span class="p">,</span> <span class="n">repo</span><span class="p">.</span><span class="n">Id</span><span class="p">);</span>
            <span class="n">row</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="s">"NAME"</span><span class="p">,</span> <span class="n">repo</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
            <span class="n">row</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="s">"URL"</span><span class="p">,</span> <span class="n">repo</span><span class="p">.</span><span class="n">HtmlUrl</span><span class="p">);</span>
            <span class="n">table</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">row</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>A classe <strong>Program</strong> é bem simples. Criamos uma instância de RfcServer usando os parâmetros definidos no arquivo de configuração e informamos quais as classes que irão responder às chamadas remotas. Neste caso só temos uma, a <strong>MyRfcHandler</strong>, mas poderiam haver outras. Todo método remoto deve ser marcado como <strong>static void</strong> e possui um atributo <strong>[RfcServerFunction]</strong> onde informamos o nome da função que criamos no ABAP. É baseado nestas configurações que o NCo sabe qual o método .NET que deve ser invocado quando receber uma chamada remota.</p>

<p>Esta função utiliza o Octokit para fazer a consulta no GitHub e preencher a tabela de retorno REPOS com os dados obtidos. Até o momento só haviamos visto como trabalhar com tipos primitivos no NCo. Neste exemplo tive que usar tabelas, mas como você pode ver no código acima não é nenhum bicho de 7 cabeças. O segredo está em conhecer as classes <strong>IRfcTable</strong>, <strong>IRfcStructure</strong> e <strong>RfcStructureMetadata</strong>.</p>

<p>Já estamos prontos para colocar nosso servidor RFC para funcionar, basta iniciar executar a aplicação.</p>

<h2 id="registration-of-tp-dotnet_server-from-host--not-allowed">registration of tp DOTNET_SERVER from host <sua-maquina> not allowed</sua-maquina></h2>

<p>Caso você receba a mensagem de erro acima, não se apavore, pois isto é normal.</p>

<p>O SAP Gateway possui um controle de segurança onde somente hosts autorizados podem ser registradas como servidores externos.</p>

<p>Para adicionar nosso host nesta lista acesse a transação <strong>SMGW -&gt; Goto -&gt; Parameters -&gt; Display</strong>.</p>

<p>Procure pelos parâmetros <strong>gw/sec_info</strong> e <strong>gw/reg_info</strong> e veja qual o caminho e nome do arquivo de cada um deles. Se for uma instalação nova é muito provável que estes arquivos nem existam ainda. Se este for o caso, crie-os primeiro.</p>

<p>Os meus arquivos ficaram assim:</p>

<p>secinfo.DAT</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#VERSION=2
P TP=DOTNET_SERVER
</code></pre></div></div>

<p>reginfo.DAT</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#VERSION=2
P HOST=NOTE-OENNING USER=BCUSER TP=DOTNET_SERVER
</code></pre></div></div>

<p>Substitua o HOST, USER e TP pelos valores que você está usando.</p>

<p>Recomendo este <a href="http://help.sap.com/saphelp_nw73/helpdata/en/e2/16d0427a2440fc8bfc25e786b8e11c/content.htm">link do help.sap</a> para maiores informações sobre estas configurações.</p>

<p>Feito isto acesso o menu <strong>SMGW -&gt; Goto -&gt; Expert Functions -&gt; External Security -&gt; Reread</strong>. Isto fará com que o SAP recarregue as configurações de segurança sem ter que reiniciá-lo por completo.</p>

<p>Agora sim podemos tentar executar nosso servidor novamente. Se der certo, a mensagem ‘Server running. Press key to stop…’ deve aparecer no console.</p>

<p>Pronto, isto é tudo o que precisamos no lado .NET. Agora podemos voltar ao ABAP.</p>

<h2 id="finalmente-a-chamada-da-função">Finalmente, a chamada da função</h2>

<p>Vamos criar uma tela onde o usuário digita o nome do login do GitHub que ele gostaria de ver os repositórios. Usamos nosso servidor .NET para fazer a consulta e então exibimos os repositórios na tela. O código fica assim:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>REPORT zrfc_list_github_repo.

PARAMETERS: p_user TYPE syuname OBLIGATORY.

START-OF-SELECTION.
  DATA: lt_repos TYPE ztbl_gh_repo.
  FIELD-SYMBOLS: &lt;fs_repo&gt; TYPE zstr_gh_repo.

  CALL FUNCTION 'LIST_GITHUB_REPO'
    DESTINATION 'DOTNET_SERVER'
    EXPORTING
      user  = p_user
    IMPORTING
      repos = lt_repos.

  LOOP AT lt_repos ASSIGNING &lt;fs_repo&gt;.
    WRITE: / &lt;fs_repo&gt;-id, 16 &lt;fs_repo&gt;-name , 50 &lt;fs_repo&gt;-url.
  ENDLOOP.
</code></pre></div></div>

<p>Ao executar o código, o resultado é este:</p>

<p><img src="/public/images/2015/03/rfc_dotnet_result.png" alt="" /></p>

<p>Pronto, funcionou! Veja que bacana, conseguimos integrar nosso SAP com o GitHub.</p>

<p>Já parou para pensar quanta coisa legal podemos fazer com isto? Principalmente em se tratando de integrações com sistemas externos como Correios, Serasa, Facebook, Twitter, Sefaz dentre outros serviços. Mas sem dúvida alguma a grande utilidade disto está na comunicação do SAP com sistema legados ou banco de dados externos. Vale a pena ressaltar que a SAP possui uma ferramenta criada exclusivamente para integração baseada em mensageria, o chamado  <strong>SAP Process Orchestration</strong> (antigo <strong>Process Integration</strong> ou <strong>Exchange Infrastructure</strong>). Vai de cada projeto ou cenário optar por escolher entre um ou outro. Uma das vantagens do NCo/JCo é o baixo custo, pois enquanto o Process Orchestration possui uma licença independente, a RFC vem de ‘grátis’ no SAP.</p>

<p>Abraços!</p>

  </div>
  <a href="https://twitter.com/intent/tweet?text=Chamando+fun%C3%A7%C3%B5es+.NET+com+SAP+RFC+by+@goenning&url=https%3A%2F%2Fgoenning.net%2F2015%2F03%2F13%2Fchamando-funcoes-net-com-sap-rfc%2F">Discuss on Twitter</a> <small>•</small> <a href="https://github.com/goenning/goenning.github.io/tree/master/_posts/2015/2015-03-13-chamando-funcoes-net-com-sap-rfc.md">Edit on GitHub</a>
</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          <a href="mailto:me@goenning.net" aria-label="Email" target="_blank" rel="noopener"><i class="svg-icon email"></i></a>
<a href="https://github.com/goenning" aria-label="GitHub" target="_blank" rel="noopener"><i class="svg-icon github"></i></a>
<a href="https://www.linkedin.com/in/goenning" aria-label="LinkedIn" target="_blank" rel="noopener"><i class="svg-icon linkedin"></i></a>
<a href="/feed.xml" aria-label="RSS Feed" target="_blank" rel="noopener"><i class="svg-icon rss"></i></a>
<a href="https://www.twitter.com/goenning" aria-label="Twitter" target="_blank" rel="noopener"><i class="svg-icon twitter"></i></a>




        </footer>
      </div>
    </div>
  </body>
</html>
